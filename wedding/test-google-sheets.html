<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Google Sheets Integration</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #45a049; }
        .result { margin-top: 20px; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .steps { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>Test Google Sheets Integration</h1>
    
    <div class="steps">
        <h2>Setup Steps:</h2>
        <ol>
            <li><strong>Create Google Sheet:</strong> Go to <a href="https://sheets.google.com" target="_blank">Google Sheets</a> and create a new spreadsheet</li>
            <li><strong>Add Headers:</strong> In row 1, add: Name, Phone, Method, Attendance, Transport, Notes, Date</li>
            <li><strong>Set up Apps Script:</strong> Go to Extensions > Apps Script and paste the code below</li>
            <li><strong>Deploy:</strong> Click Deploy > New deployment > Web app > Anyone > Copy the URL</li>
            <li><strong>Test:</strong> Paste the URL below and test the form</li>
        </ol>
    </div>

    <h2>Google Apps Script Code:</h2>
    <pre style="background: #f4f4f4; padding: 15px; border-radius: 4px; overflow-x: auto;">
function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  
  sheet.appendRow([
    data.name,
    data.phone,
    data.method,
    data.attendance,
    data.transport || '',
    data.notes || '',
    new Date()
  ]);
  
  return ContentService.createTextOutput(JSON.stringify({status: 'success'}))
    .setMimeType(ContentService.MimeType.JSON);
}
    </pre>

    <h2>Test Form:</h2>
    <form id="testForm">
        <div class="form-group">
            <label for="sheetsUrl">Google Sheets Web App URL:</label>
            <input type="url" id="sheetsUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec" required>
        </div>
        
        <div class="form-group">
            <label for="testName">Name:</label>
            <input type="text" id="testName" value="Test User" required>
        </div>
        
        <div class="form-group">
            <label for="testPhone">Phone:</label>
            <input type="tel" id="testPhone" value="+263 78 123 4567" required>
        </div>
        
        <div class="form-group">
            <label for="testMethod">Method:</label>
            <select id="testMethod">
                <option value="Web Form">Web Form</option>
                <option value="WhatsApp">WhatsApp</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="testAttendance">Attendance:</label>
            <select id="testAttendance">
                <option value="yes">Yes, attending</option>
                <option value="no">No, not attending</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="testTransport">Transport:</label>
            <select id="testTransport">
                <option value="">Not specified</option>
                <option value="yes">Needs transport</option>
                <option value="no">Own transport</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="testNotes">Notes:</label>
            <textarea id="testNotes" rows="3" placeholder="Test notes...">This is a test RSVP submission</textarea>
        </div>
        
        <button type="submit">Test Submit to Google Sheets</button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('testForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const sheetsUrl = document.getElementById('sheetsUrl').value;
            const testData = {
                name: document.getElementById('testName').value,
                phone: document.getElementById('testPhone').value,
                method: document.getElementById('testMethod').value,
                attendance: document.getElementById('testAttendance').value,
                transport: document.getElementById('testTransport').value,
                notes: document.getElementById('testNotes').value
            };
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Sending data...</p>';
            
            try {
                const response = await fetch(sheetsUrl, {
                    method: 'POST',
                    body: JSON.stringify(testData),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '<div class="result success">✅ Success! Check your Google Sheet - the data should be there!</div>';
                } else {
                    resultDiv.innerHTML = '<div class="result error">❌ Error: ' + response.status + ' ' + response.statusText + '</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="result error">❌ Error: ' + error.message + '</div>';
            }
        });
    </script>

    <h2>Common Issues & Solutions:</h2>
    <ul>
        <li><strong>CORS Error:</strong> Make sure your Apps Script is deployed as a "Web app" with "Anyone" access</li>
        <li><strong>404 Error:</strong> Check that your Web App URL is correct</li>
        <li><strong>Permission Error:</strong> Make sure you've authorized the Apps Script</li>
        <li><strong>No Data in Sheet:</strong> Check the Apps Script logs for errors</li>
    </ul>

    <h2>Next Steps:</h2>
    <ol>
        <li>Test this form with your Google Sheets setup</li>
        <li>Once working, integrate the code into your wedding website</li>
        <li>Deploy your website when ready</li>
    </ol>
</body>
</html> 